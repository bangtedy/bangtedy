---
title: Big Book 2
author: BB
date: '2020-09-19'
slug: big-book-2
categories:
  - R
tags:
  - plot
description: ''
---

```{r}

library (haven) #paket untuk mengimpor data spss
library (ggplot2)
library (gridExtra)
ce.cs <- read_sav("ce.cs.sav") #perintah mengimpor data SPSS
```

### Eksplorasi pengalaman pelanggan dengan lima indikator pengalaman dengan grafik
Beberapa perintah berikut, akan kita gunakan untuk melihat grafik persebaran rating yang diberikan oleh responden tentang pengalaman menggunakan layanan di sektor kesehatan.
```{r}
ce1 <- ggplot(ce.cs, aes(factor(CE1))) +
  geom_bar(fill="blue") + ylab("") +
  xlab("CE1(reliability)") + ylim(0, 225)

ce2 <- ggplot(ce.cs, aes(factor(CE2))) +
  geom_bar(fill="red") + ylab("") +
  xlab("CE2(right diagnosis)") + ylim(0, 225)

ce3 <- ggplot(ce.cs, aes(factor(CE3))) +
  geom_bar(fill="orange") + ylab("") +
  xlab("CE3(right treatment)") + ylim(0, 225)

ce4 <- ggplot(ce.cs, aes(factor(CE4))) +
  geom_bar(fill="yellow") + ylab("") +
  xlab("CE4(verbal com.)") + ylim(0, 225)

ce5 <- ggplot(ce.cs, aes(factor(CE5))) +
  geom_bar(fill="green") + ylab("") +
  xlab("CE5(non-verbal com.)") + ylim(0, 225)

grid.arrange(ce1,ce2,ce3,ce4,ce5, nrow=1)
```

Berdasarkan grafik di atas, terlihat bahwa pelanggan layanan kesehatan di Nigeria sebagian besar setuju dengan indikator-indikator pengukur pengalaman layanan. Dengan kata lain, sebagian pelanggan (300 orang lebih, kecuali indikator non-verbal communication) memperoleh pengalaman menyenangkan untuk indikator reliability, right diagnosis, right treatment, verbal communication dan non-verbal communication. 

### Eksplorasi kepuasan pelanggan yang diukur dengan lima indikator kepuasan
Beberapa perintah dibawah, akan kita gunakan untuk melihat grafik distribusi rating yang diberikan oleh responden tentang kepuasan dari menggunakan layanan di sektor kesehatan.

```{r}
cs1 <- ggplot(ce.cs, aes(factor(CS1))) +
	geom_bar(fill="#e05561") + ylab("") +
    xlab("CS1(reliability)") + ylim(0, 200)
           
cs2 <- ggplot(ce.cs, aes(factor(CS2))) +
    geom_bar(fill="#42b3c2") + ylab("") +
    xlab("CS2(professional)")+ ylim(0, 200)
           
cs3 <- ggplot(ce.cs, aes(factor(CS3))) +
    geom_bar(fill="#8cc265") + ylab("") +
    xlab("CS3(privacy)") + ylim(0, 200)
           
cs4 <- ggplot(ce.cs, aes(factor(CS4))) +
    geom_bar(fill="#f0a45d") + ylab("") +
    xlab("CS4(aroma)") + ylim(0, 200)
           
cs5 <- ggplot(ce.cs, aes(factor(CS5))) +
    geom_bar(fill="#29244b") + ylab("") +
    xlab("CS5(cleanliness)") + ylim(0, 200)

grid.arrange(cs1,cs2,cs3,cs4,cs5, nrow=1)
```

Berdasarkan grafik di atas, dapat ditarik kesimpulan bahwa sebagian besar pelanggan sektor  kesehatan di Nigeria menyatakan puas dengan reliability, professional, privacy, aroma dan cleanliness indikator. Langkah selanjutnya adalah membuat scatter plot untuk melihat hubungan antara customer experience dan customer satisfaction.

```{r}
ggplot(ce.cs, aes(Customerexperience, Customersatisfaction)) + geom_point() +
  geom_smooth(method="lm", colour="red") +
  geom_abline(slope=1, intercept=0)
```

Hasil scatter plot menunjukkan bahwa terdapat hubungan yang searah antara pengalaman menggunakan layanan kesehatan dengan kepuasannya. Pelanggan yang memberi rating tinggi untuk indikator pengalaman secara umum juga memberikan rating tinggi untuk indikator kepuasan, walaupun tidak setinggi rating yang mereka berikan pada indikator pengalaman. Hal ini menunjukkan bahwa masih ada variabilitas pada kepuasan pelanggan yang tidak dapat dijelaskan oleh model ini. 

Perintah selanjutnya kita gunakan untuk mengeksplorasi lebih jauh, apakah ada kemungkinan hubungan antara kepuasan konsumen dengan pengalaman konsumen tidak linier. Perintah ini untuk membuat plot smoother dan garis regresi terbaik (*the best ﬁt regression line*) secara bersama-sama.  

```{r}
ggplot(ce.cs, aes(Customerexperience, Customersatisfaction)) + geom_point() +
  geom_smooth(method="lm", colour="red", se=FALSE) + stat_smooth()
```

Hasil plotting menunjukkan bahwa untuk data ini, model linier sudah sesuai, karena kedua garis praktis berhimpitan. Tahap selanjutnya, Anda tinggal membuat perintah regresi sunflower: herb: blossom: